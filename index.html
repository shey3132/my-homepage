<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>×“×£ ×”×‘×™×ª</title>
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --accent:#2b88ff;
  --panel: rgba(255,255,255,0.94);
  --card: rgba(255,255,255,0.18);
  --radius:12px;
  --muted: rgba(0,0,0,0.55);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Assistant, Arial, sans-serif;background:linear-gradient(135deg,#b6f0e1,#c6d9ff);color:#111}
body{padding:16px;display:flex;justify-content:center;min-height:100vh}
.container{width:100%;max-width:1200px}
.header{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:12px}
.datetime{background:var(--panel);padding:12px 18px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.08);text-align:center;min-width:300px}
.greeting{font-weight:700;margin-bottom:6px;display:block}
#datetime{font-size:15px;color:var(--muted)}
.tabs{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
.tab-btn{padding:8px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);cursor:pointer;background:transparent;font-weight:700}
.tab-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}
section.panel{display:none;background:var(--panel);border-radius:12px;padding:14px;box-shadow:0 12px 30px rgba(0,0,0,0.08)}
section.panel.active{display:block}
.search-row{display:flex;justify-content:center;gap:8px;margin:10px 0}
.search-row input[type="text"]{width:100%;max-width:700px;padding:10px;border-radius:10px 0 0 10px;border:1px solid rgba(0,0,0,0.08);outline:none}
.search-row button{padding:10px;border-radius:0 10px 10px 0;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
.controls{display:flex;gap:8px;justify-content:center;margin-bottom:12px;flex-wrap:wrap}
.controls .card{display:flex;align-items:center;gap:8px}
.controls button{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);background:#fff;cursor:pointer;font-weight:700}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}
.card{background:var(--card);border-radius:12px;padding:12px;text-align:center;box-shadow:0 8px 24px rgba(0,0,0,0.08);backdrop-filter:blur(6px)}
.card:hover{transform:translateY(-6px);transition:transform .18s}
.site-logo{width:56px;height:56px;object-fit:contain;margin-bottom:8px;border-radius:10px;background:white;padding:6px;box-shadow:0 4px 12px rgba(0,0,0,0.06)}
.card a,.card label{display:block;font-weight:700;color:inherit;text-decoration:none;cursor:pointer}
.card small{display:block;margin-top:6px;color:var(--muted)}
.calendar{max-width:420px;margin:0 auto;text-align:center}
#calendar-title{font-weight:700;margin-bottom:8px}
table.calendar-table{width:100%;border-collapse:collapse;margin-top:8px}
table.calendar-table th,table.calendar-table td{padding:8px;border:1px solid rgba(0,0,0,0.06);text-align:center}
table.calendar-table th{background:rgba(0,0,0,0.04);font-weight:700}
.today-circle{display:inline-block;width:36px;height:36px;line-height:36px;border-radius:50%;background:var(--accent);color:#fff}
input,textarea,select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);font-size:14px}
button.main-btn{padding:8px 10px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer;font-weight:700}
.row{display:flex;gap:14px;align-items:flex-start}
.col{flex:1;min-width:260px}
ul.todo-list{list-style:none;padding:0;margin:0}
ul.todo-list li{display:flex;gap:8px;align-items:center;padding:8px 6px;border-bottom:1px dashed rgba(0,0,0,0.04)}
.done{ text-decoration:line-through;color:rgba(0,0,0,0.45)}
.chat-box{max-height:240px;overflow:auto;padding:8px;border-radius:8px;background:rgba(255,255,255,0.98);border:1px solid rgba(0,0,0,0.04)}
.msg{margin:6px 0;padding:8px;border-radius:10px;background:rgba(0,0,0,0.04)}
.msg.me{background:var(--accent);color:#fff;text-align:right}
.bg-gallery{display:flex;gap:8px;flex-wrap:wrap}
.bg-thumb{width:80px;height:54px;border-radius:8px;background-size:cover;background-position:center;cursor:pointer;border:2px solid rgba(0,0,0,0.06)}
@media (max-width:900px){ .row{flex-direction:column} .calendar{max-width:100%} }
</style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="datetime" role="region" aria-live="polite">
        <span id="greeting" class="greeting">×©×œ×•×!</span>
        <span id="datetime">×˜×•×¢×Ÿ...</span>
      </div>

      <div class="tabs" role="tablist" aria-label="×›×¨×˜×™×¡×™×•×ª">
        <button class="tab-btn active" data-tab="home">×“×£ ×”×‘×™×ª</button>
        <button class="tab-btn" data-tab="tools">×›×œ×™×</button>
        <button class="tab-btn" data-tab="personal">××™×©×™</button>
        <button class="tab-btn" data-tab="design">×¢×™×¦×•×‘</button>
        <button class="tab-btn" data-tab="map">××¤×”</button>
      </div>
    </header>

    <!-- HOME (×¢×›×©×™×• ×¢× ×”×•×¡×¤×ª ×§×™×¦×•×¨×™×) -->
    <section id="home" class="panel active" role="tabpanel">
      <div class="search-row">
        <input id="google-search" type="text" placeholder="×—×¤×© ×‘×’×•×’×œ..." aria-label="×—×™×¤×•×© ×‘×’×•×’×œ">
        <button id="search-btn" class="main-btn">×—×¤×©</button>
      </div>

      <div class="controls">
        <!-- ×”×•×¡×¤×ª ×§×™×¦×•×¨×™ ×“×¨×š ×›××Ÿ (×”×•×¢×‘×¨ ×'××™×©×™') -->
        <label class="card" style="display:flex;align-items:center;gap:8px;">
          <input id="shortcut-title" type="text" placeholder="×©× (××•×¤×¦×™×•× ×œ×™)" style="width:180px">
          <input id="shortcut-url" type="text" placeholder="https://..." style="width:300px">
          <button id="add-shortcut" class="main-btn">×”×•×¡×£ ×§×™×©×•×¨</button>
          <button id="export-shortcuts" style="background:#16a085">×™×™×¦× JSON</button>
        </label>
      </div>

      <div class="row">
        <div class="col">
          <div class="grid" id="home-grid">
            <!-- ×›×¨×˜×™×¡×™× ×¡×˜×˜×™×™× â€” ×œ×•×’×•××™× × ×˜×¢× ×™× ×“×¨×š google favicons -->
            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=kore.co.il" alt="Kore" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;56&quot; height=&quot;56&quot;></svg>'">
              <a href="https://www.kore.co.il/" target="_blank" rel="noopener">Kore - ×—×“×©×•×ª</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=amazon.com" alt="Amazon">
              <a href="https://www.amazon.com" target="_blank" rel="noopener">Amazon</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=ebay.com" alt="eBay">
              <a href="https://www.ebay.com" target="_blank" rel="noopener">eBay</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=zap.co.il" alt="Zap">
              <a href="https://www.zap.co.il/" target="_blank" rel="noopener">Zap</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=chat.openai.com" alt="ChatGPT">
              <a href="https://chat.openai.com" target="_blank" rel="noopener">×¦'××˜ GPT</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=mail.google.com" alt="Gmail">
              <a href="https://mail.google.com" target="_blank" rel="noopener">Gmail</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=outlook.live.com" alt="Outlook">
              <a href="https://outlook.live.com" target="_blank" rel="noopener">Outlook</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=drive.google.com" alt="Google Drive">
              <a href="https://drive.google.com" target="_blank" rel="noopener">Google Drive</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=dropbox.com" alt="Dropbox">
              <a href="https://www.dropbox.com" target="_blank" rel="noopener">Dropbox</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=youtube.com" alt="YouTube">
              <a href="https://www.youtube.com" target="_blank" rel="noopener">YouTube</a>
            </div>

            <div class="card">
              <img class="site-logo" src="https://www.google.com/s2/favicons?sz=64&domain=ims.gov.il" alt="IMS">
              <a href="https://www.ims.gov.il/" target="_blank" rel="noopener">××–×’ ××•×•×™×¨ (IMS)</a>
            </div>

            <!-- ×›××Ÿ ×™×ª×•×•×¡×¤×• ×›×¨×˜×™×¡×™ ××©×ª××© (class user-shortcut) ×“×™× ××™×ª -->
          </div>
        </div>

        <div class="col">
          <div class="calendar" id="calendar-panel">
            <div id="calendar-title">×˜×•×¢×Ÿ...</div>
            <table class="calendar-table" id="calendar-table" role="table" aria-label="×œ×•×— ×©× ×”"></table>
          </div>
        </div>
      </div>
    </section>

    <!-- TOOLS -->
    <section id="tools" class="panel" role="tabpanel">
      <div class="row">
        <div class="col">
          <h3>××—×©×‘×•×Ÿ ××”×™×¨</h3>
          <div class="card">
            <input id="calc-input" type="text" placeholder="×”×§×œ×“ ×‘×™×˜×•×™ (×œ××©×œ 12+5*3)" />
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="calc-eval" class="main-btn">×—×©×‘</button>
              <button id="calc-clear" style="background:#777">× ×§×”</button>
            </div>
            <div id="calc-result" class="muted" style="margin-top:8px"></div>
          </div>

          <h3 style="margin-top:12px">×¡×˜×•×¤×¨ / ×˜×™×™××¨</h3>
          <div class="card">
            <div id="timer-display" style="font-weight:700;font-size:20px;text-align:center">00:00:00</div>
            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;justify-content:center">
              <button id="start-timer" class="main-btn">×”×ª×—×œ</button>
              <button id="pause-timer" style="background:#f39c12">×”×©×”×”</button>
              <button id="reset-timer" style="background:#c0392b">××¤×¡</button>
              <input id="set-minutes" type="number" min="0" placeholder="×“×§×•×ª (×˜×™×™××¨)" style="width:120px" />
              <button id="start-countdown" style="background:#16a085">×”×ª×—×œ ×˜×™×™××¨</button>
            </div>
          </div>
        </div>

        <div class="col">
          <h3>×ª×¨×’×•× ××”×™×¨</h3>
          <div class="card">
            <textarea id="translate-text" rows="4" placeholder="×”×›× ×¡ ×˜×§×¡×˜ ×œ×ª×¨×’×•×..."></textarea>
            <div style="display:flex;gap:8px;margin-top:8px">
              <select id="translate-to">
                <option value="he">×¢×‘×¨×™×ª</option>
                <option value="en">×× ×’×œ×™×ª</option>
                <option value="es">×¡×¤×¨×“×™×ª</option>
                <option value="fr">×¦×¨×¤×ª×™×ª</option>
              </select>
              <button id="do-translate" class="main-btn">×ª×¨×’× (Google)</button>
              <button id="swap-lang" style="background:#888">×”×—×œ×£</button>
            </div>
            <small class="muted">×™×¤×ª×— ××ª Google Translate ×‘×—×œ×•×Ÿ ×—×“×©</small>
          </div>
        </div>
      </div>
    </section>

    <!-- PERSONAL -->
    <section id="personal" class="panel" role="tabpanel">
      <div class="row">
        <div class="col">
          <h3>×¤×ª×§×™× ××™×©×™×™×</h3>
          <div class="card">
            <textarea id="notes-area" rows="8" placeholder="×”×¢×¨×•×ª â€” × ×©××¨×•×ª ×‘×“×¤×“×¤×Ÿ"></textarea>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="save-notes" class="main-btn">×©××•×¨</button>
              <button id="clear-notes" style="background:#999">× ×§×”</button>
            </div>
          </div>

          <h3 style="margin-top:12px">×¨×©×™××ª ××©×™××•×ª</h3>
          <div class="card">
            <div style="display:flex;gap:8px;margin-bottom:8px">
              <input id="todo-input" type="text" placeholder="×”×•×¡×£ ××©×™××”..." />
              <button id="add-todo" class="main-btn">×”×•×¡×£</button>
            </div>
            <ul id="todo-list" class="todo-list" aria-live="polite"></ul>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="clear-done" style="background:#888">× ×§×” ××¡×•×× ×•×ª</button>
              <button id="clear-all" style="background:#c0392b">× ×§×” ×”×›×œ</button>
            </div>
          </div>
        </div>

        <div class="col">
          <h3>×§×™×¦×•×¨×™ ×“×¨×š ××ª×§×“××™× (×¨×©×™××”)</h3>
          <div class="card">
            <div id="shortcuts-area" style="margin-top:10px"></div>
          </div>

          <!-- gallery removed from personal and moved to design -->
        </div>
      </div>
    </section>

    <!-- DESIGN (×›××Ÿ × ××¦× ×›×¢×ª ×’×œ×¨×™×™×ª ×”×¨×§×¢×™×) -->
    <section id="design" class="panel" role="tabpanel">
      <div class="row">
        <div class="col">
          <h3>×©×™× ×•×™ ×¤×•× ×˜</h3>
          <div class="card">
            <select id="font-select">
              <option value="'Assistant', Arial, sans-serif">Assistant (×‘×¨×™×¨×ª ××—×“×œ)</option>
              <option value="'Varela Round', Arial, sans-serif">Varela Round</option>
              <option value="'Courier New', monospace">Monospace</option>
              <option value="'Times New Roman', serif">Times</option>
            </select>
            <div style="margin-top:8px"><button id="apply-font" class="main-btn">×”×—×œ ×¤×•× ×˜</button></div>
          </div>

          <h3 style="margin-top:12px">×—×’×™× / ×ª××¨×™×›×™× ×—×©×•×‘×™×</h3>
          <div class="card">
            <div style="display:flex;gap:8px">
              <input id="holiday-date" type="date" />
              <input id="holiday-title" type="text" placeholder="×©× ×”××™×¨×•×¢" />
            </div>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="add-holiday" class="main-btn">×”×•×¡×£</button>
            </div>
            <ul id="holidays-list" style="margin-top:8px"></ul>
          </div>
        </div>

        <div class="col">
          <h3>× ×™×”×•×œ ×¨×§×¢ </h3>
          <div class="card">
            <div style="display:flex;gap:8px;align-items:center">
              <label style="display:flex;gap:8px;align-items:center;cursor:pointer">
                <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'></svg>" style="width:40px;height:40px;background:#fff;padding:6px;border-radius:8px">
                <span>×”×¢×œ×” ×¨×§×¢</span>
                <input id="bg-input-design" type="file" accept="image/*" style="display:none">
              </label>
              <button id="clear-bg-design" class="main-btn">× ×§×” ×¨×§×¢</button>
              <button id="restore-default-design" style="background:#f39c12">×¨×§×¢ ×‘×¨×™×¨×ª ××—×“×œ</button>
            </div>

            <div style="display:flex;gap:8px;margin-top:12px">
              <button id="save-bg-manual" class="main-btn">×©××•×¨ ×¨×§×¢ (×× ×”×•×¢×œ×”)</button>
              <button id="clear-saved-bg" style="background:#e74c3c">××—×§ ×¨×§×¢ ×©× ×©××¨</button>
            </div>
            <div style="margin-top:8px">
              <button id="randomize-background" class="main-btn">×‘×—×¨ ×¨×§×¢ ××•×‘× ×” ××§×¨××™</button>
            </div>

            <hr style="margin:12px 0">
            <div>
              <div id="bg-gallery" class="bg-gallery"></div>
              <div style="display:flex;gap:8px;margin-top:10px">
                <button id="shuffle-bg" class="main-btn">×¨×§×¢ ××§×¨××™</button>
                <button id="reset-bg" style="background:#f39c12">××¤×¡ ×¨×§×¢</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!-- MAP -->
    <section id="map" class="panel" role="tabpanel">
      <div style="display:flex;gap:8px;align-items:center;justify-content:center;margin-bottom:10px">
        <input id="map-search" type="text" placeholder="×—×¤×© ××™×§×•× ×‘××¤×” (×›×ª×•×‘×ª/×¢×™×¨)..." style="max-width:600px" />
        <button id="map-search-btn" class="main-btn">×—×¤×© ×‘××¤×”</button>
      </div>
      <div style="width:100%;height:520px;">
        <iframe id="gmap-frame" src="https://www.google.com/maps?q=Tel+Aviv,Israel&output=embed" style="width:100%;height:100%;border:0;border-radius:8px" allowfullscreen loading="lazy"></iframe>
      </div>
      <small class="muted" style="display:block;text-align:center;margin-top:8px">×”××¤×” ×”×™× Google Maps (embed) â€” ×—×¤×© ×›×ª×•×‘×ª ×•/××• ×’×¨×•×¨ ×›×“×™ ×œ×¨××•×ª ×¤×¨×˜×™×.</small>
    </section>

    <footer style="text-align:center;margin-top:12px;color:var(--muted)">×“×©×‘×•×¨×“ ××§×•××™ â€” ×›×œ ×”× ×ª×•× ×™× × ×©××¨×™× ×‘×“×¤×“×¤×Ÿ ×©×œ×š</footer>
  </div>

<script>
/* ===== Tabs ===== */
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const id = btn.dataset.tab;
    document.querySelectorAll('section.panel').forEach(s=> s.id === id ? s.classList.add('active') : s.classList.remove('active'));
  });
});

/* ===== Date/Time/Greeting ===== */
function updateDateTime(){
  const now = new Date();
  const opts = { weekday:'long', year:'numeric', month:'long', day:'numeric' };
  document.getElementById('datetime').textContent = `ğŸ“… ${now.toLocaleDateString('he-IL', opts)} â° ${now.toLocaleTimeString('he-IL')}`;
  const h = now.getHours();
  const greeting = (h>=5 && h<12)?'×‘×•×§×¨ ×˜×•×‘ â˜€ï¸':(h<17)?'×¦×”×¨×™×™× ×˜×•×‘×™× ğŸŒ¤ï¸':(h<21)?'×¢×¨×‘ ×˜×•×‘ ğŸŒ†':'×œ×™×œ×” ×˜×•×‘ ğŸŒ™';
  document.getElementById('greeting').textContent = greeting;
}
setInterval(updateDateTime,1000); updateDateTime();

/* ===== Google Search ===== */
const searchInput = document.getElementById('google-search'), searchBtn = document.getElementById('search-btn');
function searchGoogle(){ const q=searchInput.value.trim(); if(!q) return; window.open('https://www.google.com/search?q='+encodeURIComponent(q),'_blank'); }
searchBtn.addEventListener('click', searchGoogle);
searchInput.addEventListener('keydown', e=>{ if(e.key==='Enter') searchGoogle(); });

/* ===== Calendar ===== */
function generateCalendar(){
  const now = new Date();
  const year = now.getFullYear(), month = now.getMonth(), today = now.getDate();
  const monthNames=["×™× ×•××¨","×¤×‘×¨×•××¨","××¨×¥","××¤×¨×™×œ","×××™","×™×•× ×™","×™×•×œ×™","××•×’×•×¡×˜","×¡×¤×˜××‘×¨","××•×§×˜×•×‘×¨","× ×•×‘××‘×¨","×“×¦××‘×¨"];
  const days=["×","×‘","×’","×“","×”","×•","×©"];
  document.getElementById('calendar-title').textContent = `${monthNames[month]} ${year}`;
  const firstDay = new Date(year,month,1).getDay(); // 0=Sun
  const lastDate = new Date(year,month+1,0).getDate();
  let html = '<tr>';
  for(let d of days) html += `<th>${d}</th>`; html += '</tr><tr>';
  let dayCount = 0;
  for(let i=0;i<firstDay;i++){ html += '<td class="empty"></td>'; dayCount++; }
  for(let d=1; d<=lastDate; d++){
    if(d===today) html += `<td><span class="today-circle">${d}</span></td>`;
    else html += `<td>${d}</td>`;
    dayCount++;
    if(dayCount%7===0) html += '</tr><tr>';
  }
  while(dayCount%7!==0){ html += '<td class="empty"></td>'; dayCount++; }
  html += '</tr>';
  document.getElementById('calendar-table').innerHTML = html;
}
generateCalendar();

/* ===== Background (upload + localStorage) ===== */
const BG_KEY = 'dashboard_bg_v3';
function applyBackground(v){
  if(!v){ document.body.style.background = 'linear-gradient(135deg,#b6f0e1,#c6d9ff)'; return; }
  if(v.startsWith('linear')){ document.body.style.background = v; } else {
    document.body.style.background = `linear-gradient(rgba(116,235,213,0.5), rgba(172,182,229,0.5)), url(${v})`;
    document.body.style.backgroundSize = 'cover'; document.body.style.backgroundPosition = 'center';
  }
}
(function(){ const s = localStorage.getItem(BG_KEY); if(s) applyBackground(s); })();

function handleBgFileInput(inputEl){
  inputEl.addEventListener('change', function(){
    const f = this.files && this.files[0]; if(!f) return;
    const reader = new FileReader(); reader.onload = function(e){
      const data = e.target.result;
      try{ localStorage.setItem(BG_KEY, data); applyBackground(data); alert('×¨×§×¢ × ×©××¨ ×‘×“×¤×“×¤×Ÿ'); } catch(err){ applyBackground(data); alert('×”×¨×§×¢ ×”×•×ª×§×Ÿ ××š ×œ× × ×©××¨ (×’×“×•×œ ××“×™ ×œ-localStorage)'); }
    }; reader.readAsDataURL(f);
  });
}
const bgInputDesign = document.getElementById('bg-input-design');
if(bgInputDesign) handleBgFileInput(bgInputDesign);

document.getElementById('clear-bg-design').addEventListener('click', ()=>{ localStorage.removeItem(BG_KEY); applyBackground(null); alert('×”×¨×§×¢ ×”×•×¡×¨'); });
document.getElementById('restore-default-design').addEventListener('click', ()=> applyBackground(null));
document.getElementById('save-bg-manual').addEventListener('click', ()=>{ const bg = document.body.style.background || ''; if(!bg) return alert('××™×Ÿ ×¨×§×¢ ×¤×¢×™×œ ×œ×©××™×¨×”'); try{ localStorage.setItem(BG_KEY, bg); alert('×¨×§×¢ × ×©××¨'); } catch(e){ alert('×œ× × ×™×ª×Ÿ ×œ×©××•×¨ ×¨×§×¢ ×–×”'); }});
document.getElementById('clear-saved-bg').addEventListener('click', ()=>{ localStorage.removeItem(BG_KEY); applyBackground(null); alert('×”×¨×§×¢ ×”×•×¡×¨')});
document.getElementById('randomize-background').addEventListener('click', ()=>{ const builtIn = ['linear-gradient(120deg,#89f7fe,#66a6ff)','linear-gradient(120deg,#fdfbfb,#ebedee)','https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=1200&auto=format&fit=crop','https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=1200&auto=format&fit=crop']; const r=builtIn[Math.floor(Math.random()*builtIn.length)]; applyBackground(r); localStorage.setItem(BG_KEY,r); });
/* ===== Built-in gallery population (now in design) ===== */
const builtInArr = ['linear-gradient(120deg,#89f7fe,#66a6ff)','linear-gradient(120deg,#fdfbfb,#ebedee)','https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=1200&auto=format&fit=crop','https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=1200&auto=format&fit=crop'];
const gallery = document.getElementById('bg-gallery');
function populateGallery(){ if(!gallery) return; gallery.innerHTML=''; builtInArr.forEach(b=>{ const d=document.createElement('div'); d.className='bg-thumb'; d.style.backgroundImage = b.startsWith('linear') ? b : `url(${b})`; d.addEventListener('click', ()=>{ applyBackground(b); localStorage.setItem(BG_KEY,b); }); gallery.appendChild(d); }); }
populateGallery();

document.getElementById('shuffle-bg').addEventListener('click', ()=>{ const r = builtInArr[Math.floor(Math.random()*builtInArr.length)]; applyBackground(r); localStorage.setItem(BG_KEY,r); });
document.getElementById('reset-bg').addEventListener('click', ()=>{ localStorage.removeItem(BG_KEY); applyBackground(null); });

/* ===== Shortcuts handling (localStorage + adding to home grid) ===== */
const SHORT_KEY = 'dashboard_shortcuts_v3';
function getDomainFromUrl(url){ try{ return (new URL(url)).hostname; } catch(e){ return url; } }
function updateHomeShortcutCards(arr){
  const homeGrid = document.getElementById('home-grid');
  if(!homeGrid) return;
  homeGrid.querySelectorAll('.card.user-shortcut').forEach(n => n.remove());
  arr.forEach(s => {
    const card = document.createElement('div');
    card.className = 'card user-shortcut';
    const img = document.createElement('img');
    img.className = 'site-logo';
    const domain = getDomainFromUrl(s.url);
    img.src = `https://www.google.com/s2/favicons?sz=64&domain=${encodeURIComponent(domain)}`;
    img.alt = s.title || domain;
    img.onerror = function(){ this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="56" height="56"></svg>'; };
    const a = document.createElement('a');
    a.href = s.url; a.target = '_blank'; a.rel = 'noopener';
    a.textContent = s.title || s.url;
    card.appendChild(img); card.appendChild(a);
    homeGrid.appendChild(card);
  });
}
function updateShortcutsPanel(){
  const raw = localStorage.getItem(SHORT_KEY);
  const arr = raw ? JSON.parse(raw) : [];
  const panel = document.getElementById('shortcuts-panel');
  if(panel) {
    panel.innerHTML = '';
    arr.forEach(s=>{ const a=document.createElement('a'); a.href=s.url; a.target='_blank'; a.rel='noopener'; a.textContent = s.title || s.url; panel.appendChild(a); panel.appendChild(document.createElement('br')); });
  }
  updateHomeShortcutCards(arr);
}
function renderShortcuts(arr){
  const shortcutsArea = document.getElementById('shortcuts-area');
  if(!shortcutsArea) return;
  shortcutsArea.innerHTML = '';
  arr.forEach((s, idx) => {
    const wrap = document.createElement('div');
    wrap.style.display = 'flex';
    wrap.style.justifyContent = 'space-between';
    wrap.style.alignItems = 'center';
    wrap.style.marginBottom = '8px';
    const a = document.createElement('a');
    a.href = s.url; a.target = '_blank'; a.rel = 'noopener'; a.textContent = s.title || s.url;
    const rm = document.createElement('button');
    rm.textContent = '××—×§'; rm.style.background = '#e74c3c'; rm.style.padding = '6px';
    rm.addEventListener('click', ()=>{ arr.splice(idx,1); localStorage.setItem(SHORT_KEY, JSON.stringify(arr)); renderShortcuts(arr); updateShortcutsPanel(); });
    wrap.appendChild(a); wrap.appendChild(rm);
    shortcutsArea.appendChild(wrap);
  });
  updateShortcutsPanel();
}
(function(){ const raw = localStorage.getItem(SHORT_KEY); const arr = raw ? JSON.parse(raw) : []; renderShortcuts(arr); })();

document.getElementById('add-shortcut').addEventListener('click', ()=>{
  const t = document.getElementById('shortcut-title').value.trim();
  const u = document.getElementById('shortcut-url').value.trim();
  if(!u) return alert('×”×–×Ÿ URL');
  const raw = localStorage.getItem(SHORT_KEY); const arr = raw ? JSON.parse(raw) : [];
  arr.push({ title: t || u, url: u });
  localStorage.setItem(SHORT_KEY, JSON.stringify(arr));
  document.getElementById('shortcut-title').value = ''; document.getElementById('shortcut-url').value = '';
  renderShortcuts(arr);
});

document.getElementById('export-shortcuts').addEventListener('click', ()=>{
  const raw = localStorage.getItem(SHORT_KEY); if(!raw) return alert('××™×Ÿ ×§×™×¦×•×¨×™× ×œ×™×™×¦×•×');
  const a = document.createElement('a'); a.href = 'data:application/json;charset=utf-8,'+encodeURIComponent(raw); a.download='shortcuts.json'; a.click();
});

/* ===== Calculator (safe-ish) ===== */
document.getElementById('calc-eval').addEventListener('click', ()=>{
  const expr = document.getElementById('calc-input').value.trim(); const out = document.getElementById('calc-result');
  if(!expr){ out.textContent=''; return; }
  if(!/^[0-9+\-*/().%\s]+$/.test(expr)){ out.textContent='×‘×™×˜×•×™ ×œ× ×—×•×§×™'; return; }
  try{ const sanitized = expr.replace(/%/g,'/100'); const val = Function('"use strict"; return ('+sanitized+')')(); out.textContent = '×ª×•×¦××”: ' + val; } catch(e){ out.textContent='×©×’×™××” ×‘×—×™×©×•×‘'; }
});
document.getElementById('calc-clear').addEventListener('click', ()=>{ document.getElementById('calc-input').value=''; document.getElementById('calc-result').textContent=''; });

/* ===== Stopwatch / Timer ===== */
let timerInterval=null, elapsed=0, running=false;
const timerDisplay = document.getElementById('timer-display');
function formatHMS(s){ const h=Math.floor(s/3600), m=Math.floor((s%3600)/60), sec=s%60; return [h,m,sec].map(v=>String(v).padStart(2,'0')).join(':'); }
function updateTimer(){ timerDisplay.textContent = formatHMS(elapsed); }
document.getElementById('start-timer').addEventListener('click', ()=>{ if(running) return; running=true; const start=Date.now()-elapsed*1000; timerInterval=setInterval(()=>{ elapsed=Math.floor((Date.now()-start)/1000); updateTimer(); },250); });
document.getElementById('pause-timer').addEventListener('click', ()=>{ if(timerInterval){ clearInterval(timerInterval); timerInterval=null; running=false; }});
document.getElementById('reset-timer').addEventListener('click', ()=>{ if(timerInterval){ clearInterval(timerInterval); timerInterval=null; } running=false; elapsed=0; updateTimer(); });
document.getElementById('start-countdown').addEventListener('click', ()=>{ const mins = Number(document.getElementById('set-minutes').value) || 0; if(mins<=0){ alert('×”×–×Ÿ ×“×§×•×ª ×œ×˜×™×™××¨'); return; } if(timerInterval){ clearInterval(timerInterval); timerInterval=null; } running=true; const target = Date.now() + mins*60000; timerInterval=setInterval(()=>{ const remaining = Math.max(0, Math.ceil((target - Date.now())/1000)); elapsed = remaining; updateTimer(); if(remaining<=0){ clearInterval(timerInterval); timerInterval=null; running=false; alert('×”×˜×™×™××¨ ×”×•×©×œ×'); elapsed=0; updateTimer(); } },250); });

/* ===== Translate quick ===== */
document.getElementById('do-translate').addEventListener('click', ()=>{ const txt = document.getElementById('translate-text').value.trim(); if(!txt) return alert('×”×›× ×¡ ×˜×§×¡×˜'); const to = document.getElementById('translate-to').value || 'he'; const url = `https://translate.google.com/?sl=auto&tl=${encodeURIComponent(to)}&text=${encodeURIComponent(txt)}&op=translate`; window.open(url,'_blank'); });
document.getElementById('swap-lang').addEventListener('click', ()=>{ const sel=document.getElementById('translate-to'); sel.selectedIndex=(sel.selectedIndex+1)%sel.options.length; });

/* ===== Map search (iframe to Google Maps) ===== */
const gmapFrame = document.getElementById('gmap-frame');
document.getElementById('map-search-btn').addEventListener('click', ()=>{ const q = document.getElementById('map-search').value.trim() || 'Tel Aviv, Israel'; gmapFrame.src = 'https://www.google.com/maps?q=' + encodeURIComponent(q) + '&output=embed'; });

/* ===== Notes (localStorage) ===== */
const NOTES_KEY = 'dashboard_notes_v3';
const notesArea = document.getElementById('notes-area');
document.getElementById('save-notes').addEventListener('click', ()=>{ localStorage.setItem(NOTES_KEY, notesArea.value); alert('×¤×ª×§ × ×©××¨'); });
document.getElementById('clear-notes').addEventListener('click', ()=>{ if(confirm('×œ××—×•×§ ××ª ×”×¤×ª×§?')){ notesArea.value=''; localStorage.removeItem(NOTES_KEY); }});
(function(){ const v = localStorage.getItem(NOTES_KEY); if(v) notesArea.value = v; })();

/* ===== To-Do (localStorage) ===== */
const TODO_KEY = 'dashboard_todo_v3'; const todoListEl = document.getElementById('todo-list');
function renderTodos(arr){ todoListEl.innerHTML=''; arr.forEach((it,idx)=>{ const li=document.createElement('li'); const ch=document.createElement('input'); ch.type='checkbox'; ch.checked=it.done; ch.addEventListener('change', ()=>{ arr[idx].done = ch.checked; localStorage.setItem(TODO_KEY, JSON.stringify(arr)); renderTodos(arr); }); const span=document.createElement('span'); span.textContent = it.txt; if(it.done) span.classList.add('done'); const del=document.createElement('button'); del.textContent='âœ–'; del.style.background='#e74c3c'; del.style.padding='4px 6px'; del.addEventListener('click', ()=>{ arr.splice(idx,1); localStorage.setItem(TODO_KEY, JSON.stringify(arr)); renderTodos(arr); }); li.appendChild(ch); li.appendChild(span); li.appendChild(del); todoListEl.appendChild(li); }); }
document.getElementById('add-todo').addEventListener('click', ()=>{ const txt=document.getElementById('todo-input').value.trim(); if(!txt) return; const raw=localStorage.getItem(TODO_KEY); const arr=raw?JSON.parse(raw):[]; arr.push({txt,done:false}); localStorage.setItem(TODO_KEY, JSON.stringify(arr)); renderTodos(arr); document.getElementById('todo-input').value=''; });
document.getElementById('clear-done').addEventListener('click', ()=>{ const raw=localStorage.getItem(TODO_KEY); const arr=raw?JSON.parse(raw):[]; const filtered=arr.filter(i=>!i.done); localStorage.setItem(TODO_KEY, JSON.stringify(filtered)); renderTodos(filtered); });
document.getElementById('clear-all').addEventListener('click', ()=>{ if(confirm('×œ××—×•×§ ××ª ×›×œ ×”××©×™××•×ª?')){ localStorage.removeItem(TODO_KEY); renderTodos([]); }});
(function(){ const raw=localStorage.getItem(TODO_KEY); const arr=raw?JSON.parse(raw):[]; renderTodos(arr); })();

/* ===== Shortcuts panel placeholder (for updateShortcutsPanel if used) ===== */
(function(){ const div = document.createElement('div'); div.id='shortcuts-panel'; div.style.display='none'; document.body.appendChild(div); })();

/* ===== Holidays list ===== */
const HOL_KEY = 'dashboard_holidays_v1';
function loadHolidays(){ const raw=localStorage.getItem(HOL_KEY); const arr=raw?JSON.parse(raw):[]; const ul=document.getElementById('holidays-list'); ul.innerHTML=''; arr.forEach((h,idx)=>{ const li=document.createElement('li'); li.textContent=`${h.date} â€” ${h.title}`; const rm=document.createElement('button'); rm.textContent='××—×§'; rm.style.marginLeft='8px'; rm.addEventListener('click', ()=>{ arr.splice(idx,1); localStorage.setItem(HOL_KEY, JSON.stringify(arr)); loadHolidays(); }); li.appendChild(rm); ul.appendChild(li); }); }
document.getElementById('add-holiday').addEventListener('click', ()=>{ const d=document.getElementById('holiday-date').value; const t=document.getElementById('holiday-title').value.trim(); if(!d||!t) return alert('×‘×—×¨ ×ª××¨×™×š ×•×©×'); const raw=localStorage.getItem(HOL_KEY); const arr=raw?JSON.parse(raw):[]; arr.push({date:d,title:t}); localStorage.setItem(HOL_KEY, JSON.stringify(arr)); loadHolidays(); });
loadHolidays();

/* ===== Init ===== */
(function init(){
  const savedBg = localStorage.getItem(BG_KEY); if(savedBg) applyBackground(savedBg);
  populateGallery();
  updateShortcutsPanel();
})();
</script>
</body>
</html>